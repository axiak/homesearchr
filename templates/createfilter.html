{% extends "base.html" %}

{% block extrahdrs %}
{{ block.super }}
  <link href="{{ MEDIA_URL }}css/jqueryui/jquery.ui.all.css" rel="stylesheet">

  <script src="http://www.google.com/jsapi?key={{ AJAX_KEY }}" type="text/javascript"></script>
  <script type="text/javascript" src="http://maps.google.com/maps?file=api&amp;v=2.115&amp;hl=en&amp;key={{ MAP_KEY }}"></script>

  <script language="Javascript" type="text/javascript">
  //<![CDATA[
  google.load("jquery", "1.4.2");
  google.load("jqueryui", "1.8.0");
  var zoom = {{ mapzoom }};
  var centerPoint = new GLatLng({{ centerlat }}, {{ centerlng }});
  {% ifequal REQUEST.META.SERVER_NAME "localhost" %}
  var listingURL = "/static/json/apts.json";
  {% else %} 
  var listingURL = "/apts/list/{{ CITY }}/json/";
  {% endifequal %}
  //]]>
  </script>

  <script type="text/javascript" src="{{ MEDIA_URL }}js/maps.js"></script>
  <script type="text/javascript" src="{{ MEDIA_URL }}js/create.js"></script>

<style type="text/css">
  #mapDiv {
  height: 600px;
  width: 80%;
  border: 2px solid black;
  }
  #mile-container {
  width: 500px;
  height: 50px;
  }
  #price-container {
  width: 500px;
  height: 50px;
}
  form p {
  font-size: .8em;
  font-style: italic;
  margin: 2em;
  }
  form label {
  font-size: 1.25em;
  font-style: normal;
}
  .errorlist, .errorlist li {
  color: #c00;
  font-size: 0.95em;
  font-weight: bold;
  margin: 0 0 -20px 15px;
  padding: 0;
  list-style-type: none;
  }
  #estimated-amount {
    display: inline;
    color: #999;
    font-weight: bold;
    font-size: 1.2em;
    padding-top: 15px;
    padding-left: 15px;
  }
  #loading-image {
   visibility: hidden;
   vertical-align: -43%;
  }
</style>
{% endblock %}

{% block body %}
<h2>Create Filter</h2>
<p>
  With the following page you can create a <em>filter</em>.
  Throughout the lifetime of the filter, we will send you <em>notifications</em>
  via email every day that we find apartments that match your criteria.
</p>

<form action="" method="post" name="mainform">
<hr>
<h3>Easy Questions</h3>
<p>
  These questions should be fairly straightforward.
</p>
{{ cform.as_p }}
{{ form.as_p }}

<input type="hidden" name="location-data" id="location-data" value="">
<hr>
<h3>Price Option</h3>
<p><label>
  Now please adjust the slide to enter the <em>lower</em> and <em>upper</em>
  price cutoffs. The <em>lower</em> cutoff is the point at which you don't
  care anymore. The <em>upper</em> cutoff is the point at which you will
  not consider the apartment.</label>
</p>
<div id="price-container">
  <input type="text" name="price" id="price-output" style="font-size: 1.05em; border: 0; color: #444; font-weight: bold;">
  <table border="0" style="width: 100%;"><tr><td>$500</td><td style="width: 100%;"><div id="price-range"></div>
        </td><td>$4000</td></tr></table>

</div>
<hr>
<h3>Location</h3>
<p><label>
The location filters are similar to the price filter. That is,
<em>the lower cutoff is the point at which you don't care about distance</em>.
<em>The upper cutoff is the point at which you are no longer willing to consider it.</em> Once you set your distances, click on the map to draw circles that
describe the area you are interested in.
</label>
</p>
<p>
<div id="mile-container">
  <span id="mile-output" style="color: #444; font-weight: bold;">&nbsp;</span>
  <table border="0" style="width: 100%;"><tr><td>0mi</td><td style="width: 100%;"><div id="mile-range"></div>
        </td><td>4mi</td></tr></table>
</div>
<input type="button" name="removeone" value="Remove last circle" onclick="deleteOneCircle();">
<input type="button" name="removeone" value="Clear map" onclick="deleteAllCircles();">
</p>


<div id="mapDiv">
<p style="color: red; font-size: 2em;">Google maps loading...</p>
</div>

<div id="estimated-amount">
Estimated matches: N/A 
</div>
<img src="{{ MEDIA_URL }}img/loading.gif" title="loading" id="loading-image" border="0">

<p>
<input type="submit" value="Add notification!">
</p>
</form>

{% endblock %}
